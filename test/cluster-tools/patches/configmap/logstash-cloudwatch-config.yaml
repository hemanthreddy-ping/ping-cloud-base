apiVersion: v1
kind: ConfigMap
metadata:
  name: enrichment-logstash-config
  namespace: elastic-stack-logging
  labels:
    app: logstash-elastic
data:
  cloudwatch.conf: |
    output {
      if [log_group] and [stream_name] {
        awslogs {
          region => "${REGION}"
          log_group_name => "/aws/containerinsights/${CLUSTER_NAME}/%{log_group}"
          log_stream_name => "%{stream_name}"
        }
      } else {
        awslogs {
          region => "${REGION}"
          log_group_name => "/aws/containerinsights/${CLUSTER_NAME}/application"
          log_stream_name => "%{log_type}_%{host}"
        }
      }
    }
